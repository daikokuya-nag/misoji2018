/*************************プロファイル表示順出力 Version 1.02016 Mar. 3 ver 1.0*************************//********************セッション状態の取得********************/function updProfSeqPre2() {var sess;	$.ajax({		type  : "get" ,		url   : "cgi/ajax/getSess.php" ,		cache : false ,		success : function(result) {					console.debug(result);			sess = result;		} ,		error : function(result) {					console.debug('error at updProfSeqPre2:' + result);		} ,		complete : function(result) {			if(sess == SESS_OWN_INTIME) {				writeProfSeqPre2A(sess);			} else {				alert('長時間操作がなかったため接続が切れました。ログインしなおしてください。');				$("#editProfDlg").dialog("close");				location.href = 'login.html';			}		}	});}/********************セッション情報の更新********************/function writeProfSeqPre2A(sess) {var ret;	$.ajax({		type  : "get" ,		url   : "cgi/ajax/updSess.php" ,		cache : false ,		success : function(result) {					console.debug(result);			ret = result;		} ,		error : function(result) {					console.debug('error at writeProfSeqPre2A:' + result);		} ,		complete : function(result) {			writeProfSeqDisp2();		}	});}/********************表示順を出力********************/function writeProfSeqDisp2() {var groupNo  = $('#groupNo').val();var branchNo = $('#branchNo').val();var dispSW = $(".dispProfSW2").serialize();	/* 表示/非表示の指定 */var bld = AL + ',' + RE;var idSeq = '';var listLen;	$('#profSeqListD2 tr').map(function() {				//idSeq = idSeq + jQuery(this).children('td.dir').text() + ',';		idSeq = idSeq + $(this).children('td.dir').text() + ',';	});			console.debug(idSeq);	listLen = idSeq.length;	idSeq = idSeq.substr(0 ,listLen-1);			console.debug(idSeq);				//console.debug(dispSW);///				console.debug('profOrder::' + profOrder);	$.ajax({		type : "post" ,		url  : "cgi/ajax/writeProfSeqDisp2.php" ,					//		data : profOrder ,		// see commonA.js		data : {			groupNo  : groupNo  ,			branchNo : branchNo ,			dispSW   : dispSW   ,			seq      : idSeq		} ,		cache : false  ,		success : function(result) {					console.debug(result);			ret = result;					//console.debug(ret['TITLE']);		} ,		error : function(result) {					console.debug('error at writeProfSeqDisp:' + result);		} ,		complete : function(result) {			bldProfHTML('');//			showProfListAll2();		//リスト再表示//			bldProfListHTML2(bld);//			bldProfSitemap();			alert('出力完了');		}	});}/********************リスト再表示********************/function showProfListAll2() {var groupNo  = $('#groupNo').val();var branchNo = $('#branchNo').val();var profListTag;	$.ajax({		type : "get" ,		url  : "cgi/ajax/bldProfList.php" ,		data : {			groupNo  : groupNo  ,			branchNo : branchNo		} ,		cache    : false  ,		dataType : 'json' ,		success : function(result) {					console.debug(result);			profListTag = result;					//console.debug(ret['TITLE']);		} ,		error : function(result) {					console.debug('error at showList:' + result);		} ,		complete : function(result) {					//alert(newTag['data']);			/*** ニュース埋め込み用 ***/			$("#profListD").html(profListTag['news']['data']);			/*** 定型文埋め込み用 ***/			$("#profListFPD").html(profListTag['news']['data']);			/*** プロファイルリスト ***/			$("#profSeqListD").html(profListTag['prof']['data']);			$("#profSeqList").tableDnD({				onDrop: function(table, row) {									//profOrder = $.tableDnD.serialize();									//		console.debug(profOrder);									//enableWriteProfSeq();				}			});			$(".dispProfSW").toggleSwitch();		}	});}/********************アルバムHTML、JSのファイル出力********************/function bldProfListHTML2(bld) {var groupNo  = $('#groupNo').val();var branchNo = $('#branchNo').val();	$.ajax({		type :"post" ,		url  :"cgi/ajax/bldProfHTML.php" ,		data : {			groupNo  : groupNo  ,			branchNo : branchNo ,			bld      : bld      ,			profDir  : ''		} ,		cache    :false ,//		dataType :'json' ,		success :function(result) {					console.debug(result);			ret = result;					//console.debug(ret['TITLE']);		} ,		error :function(result) {					console.debug('error at bldProfListHTML:' + result);		}	});}